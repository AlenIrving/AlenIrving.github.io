<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>XYCTF2025部分WP-Re</title>
    <link href="/2025/04/06/XYCTF2025/"/>
    <url>/2025/04/06/XYCTF2025/</url>
    
    <content type="html"><![CDATA[<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>emm,比赛到最后就剩我一个了，pwn爷来打的话能冲前60的，PYD逆向和VM逆向也要开始学起来了。</p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="WARMUP"><a href="#WARMUP" class="headerlink" title="WARMUP"></a>WARMUP</h2><p>vbs文件</p><p>参考这个</p><p><img src="/2025/04/06/XYCTF2025/1.png"></p><p><img src="/2025/04/06/XYCTF2025/2.png"></p><p>本质就是chr加密混淆</p><p><img src="/2025/04/06/XYCTF2025/3.png"></p><p>无魔改rc4，提数据痛苦</p><p><img src="/2025/04/06/XYCTF2025/4.png"></p><p><img src="/2025/04/06/XYCTF2025/5.png"></p><p>XYCTF{5f9f46c147645dd1e2c8044325d4f93c}</p><h2 id="Dragon"><a href="#Dragon" class="headerlink" title="Dragon"></a>Dragon</h2><p>bc文件逆向，学习过程见我blog，赛后会发</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>    __int64 v4; <span class="hljs-comment">// [rsp+30h] [rbp-50h]</span><br>    <span class="hljs-type">size_t</span> v5; <span class="hljs-comment">// [rsp+38h] [rbp-48h]</span><br>    <span class="hljs-type">char</span> Str[<span class="hljs-number">80</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-40h] BYREF</span><br>    _QWORD v7[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [rsp+90h] [rbp+10h] BYREF</span><br>    <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [rsp+FCh] [rbp+7Ch]</span><br><br>    _main(argc, argv, envp);<br>    v8 = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">memcpy</span>(v7, &amp;unk_140004000, <span class="hljs-number">0x60uLL</span>);<br>    <span class="hljs-built_in">memset</span>(Str, <span class="hljs-number">0</span>, <span class="hljs-number">66uLL</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input U flag:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, Str);<br>    v5 = <span class="hljs-number">0LL</span>;<br>    v4 = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">while</span> ( v5 &lt; <span class="hljs-built_in">strlen</span>(Str) &gt;&gt; <span class="hljs-number">1</span> )<br>        &#123;<br>            <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">calculate_crc64_direct</span>((<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> __int8 *)&amp;Str[v5], <span class="hljs-number">2uLL</span>) != v7[v4] )<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error!&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            &#125;<br>            v5 += <span class="hljs-number">2LL</span>;<br>            ++v4;<br>        &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Success&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>进去后是crc校验，每两位为一组</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">calculate_crc64_direct</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> __int8 *a1, <span class="hljs-type">unsigned</span> __int64 n2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 j; <span class="hljs-comment">// [rsp+0h] [rbp-28h]</span><br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+8h] [rbp-20h]</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+10h] [rbp-18h]</span><br><br>  v5 = <span class="hljs-number">-1LL</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt; n2; ++i )<br>  &#123;<br>    v5 ^= (<span class="hljs-type">unsigned</span> __int64)a1[i] &lt;&lt; <span class="hljs-number">56</span>;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0LL</span>; j &lt; <span class="hljs-number">8</span>; ++j )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v5 &gt;= <span class="hljs-number">0</span> )<br>        v5 *= <span class="hljs-number">2LL</span>;<br>      <span class="hljs-keyword">else</span><br>        v5 = (<span class="hljs-number">2</span> * v5) ^ <span class="hljs-number">0x42F0E1EBA9EA3693LL</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> ~v5;<br>&#125;<br></code></pre></td></tr></table></figure><p>密文</p><p><img src="/2025/04/06/XYCTF2025/6.png"></p><p>脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_crc64_direct</span>(<span class="hljs-params">data</span>):<br>    crc = <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>  <span class="hljs-comment"># 初始值 -1</span><br>    poly = <span class="hljs-number">0x42F0E1EBA9EA3693</span>  <span class="hljs-comment"># CRC64/ECMA 多项式</span><br><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        crc ^= (byte &lt;&lt; <span class="hljs-number">56</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>  <span class="hljs-comment"># 高位异或</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):  <span class="hljs-comment"># 处理 8 位</span><br>            <span class="hljs-keyword">if</span> (crc &amp; <span class="hljs-number">0x8000000000000000</span>) != <span class="hljs-number">0</span>:  <span class="hljs-comment"># 检查最高位</span><br>                crc = ((crc &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>) ^ poly<br>            <span class="hljs-keyword">else</span>:<br>                crc = (crc &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> (~crc) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>  <span class="hljs-comment"># 取反并确保 64 位</span><br><br><br><span class="hljs-comment"># 给定的 96 字节密文</span><br>cipher_bytes = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x3</span>,<br>    <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x83</span>,<br>    <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x93</span>,<br>    <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD</span>,<br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x92</span>,<br>    <span class="hljs-number">0xB</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x9B</span><br>])<br><br><span class="hljs-comment"># 转换为 12 个 64 位整数（小端序）</span><br>v7 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(cipher_bytes), <span class="hljs-number">8</span>):<br>    chunk = cipher_bytes[i:i + <span class="hljs-number">8</span>]<br>    value = <span class="hljs-built_in">int</span>.from_bytes(chunk, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br>    v7.append(value)<br><br><span class="hljs-comment"># 枚举所有 2 字节组合，计算 CRC64 并匹配</span><br>flag = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> target <span class="hljs-keyword">in</span> v7:<br>    found = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x10000</span>):  <span class="hljs-comment"># 0x0000 ~ 0xFFFF</span><br>        data = i.to_bytes(<span class="hljs-number">2</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br>        crc = calculate_crc64_direct(data)<br>        <span class="hljs-keyword">if</span> crc == target:<br>            flag += data<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found: <span class="hljs-subst">&#123;data.<span class="hljs-built_in">hex</span>()&#125;</span> -&gt; <span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(crc)&#125;</span>&quot;</span>)<br>            found = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Failed for <span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(target)&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>))<br><span class="hljs-comment">#flag&#123;LLVM_1s_Fun_Ri9h7?&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BC文件逆向</title>
    <link href="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/"/>
    <url>/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<p>参考链接：<a href="https://blog.csdn.net/weixin_47778392/article/details/141107768">https://blog.csdn.net/weixin_47778392&#x2F;article&#x2F;details&#x2F;141107768</a></p><p><a href="https://www.cnblogs.com/Q7h2q9/p/18590724">https://www.cnblogs.com/Q7h2q9/p/18590724</a></p><h1 id="LLVM"><a href="#LLVM" class="headerlink" title="LLVM"></a>LLVM</h1><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/1.png"></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/2.png"></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/3.png"></p><h1 id="BC-bitcode-逆向"><a href="#BC-bitcode-逆向" class="headerlink" title="BC(bitcode)逆向"></a>BC(bitcode)逆向</h1><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/4.png"></p><p><a href="https://blog.csdn.net/pc153262603/article/details/89553688">clang llc llvm 常用编译指令-CSDN博客</a></p><ol><li><font style="color:rgba(0, 0, 0, 0.75);">将C文件编译为LLVM bitcode 文件</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang -o3  -emit-llvm hello.c -c -o hello.bc<br></code></pre></td></tr></table></figure><ol start="2"><li><font style="color:rgba(0, 0, 0, 0.75);">由于.bc 是bitcode的二进制格式，.ll 文件 llvm bitcode 的可读文本</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang -o3  -emit-llvm hello.c -S -o hello.ll<br></code></pre></td></tr></table></figure><p><a href="https://so.csdn.net/so/search?q=llvm&spm=1001.2101.3001.7020"><font style="color:rgb(252, 85, 49);">llvm</font></a><font style="color:rgb(77, 77, 77);">-dis 工具</font><font style="color:rgb(252, 85, 49);">反汇编</font><font style="color:rgb(77, 77, 77);">llvm bitcode 文件， 可以将bc文件转为.ll文件</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">llvm-dis hello.bc<br></code></pre></td></tr></table></figure><ol start="3"><li><font style="color:rgba(0, 0, 0, 0.75);">用 llvm-as 工具通过汇编文件（.ll 文件）得到字节码文件（.bc 文件）</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">llvm-as hello.ll hello.bc<br></code></pre></td></tr></table></figure><ol start="4"><li><font style="color:rgba(0, 0, 0, 0.75);">.bc编译成.o<br></font><font style="color:rgba(0, 0, 0, 0.75);">第一种方法：用clang直接将其编译为可执行文件</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang a.o.bc -o struct<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">第二种方法：用llc先将bc编译为汇编，再用本地的gcc将其编译为可执行文件。<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">llc a.o.bc -o hello.s<br>gcc hello.s -o hello<br></code></pre></td></tr></table></figure><ol start="5"><li><font style="color:rgba(0, 0, 0, 0.75);">编译生成可执行文件</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang hello.c -o hello<br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);">或者</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang -emit-llvm -c hello.c<br></code></pre></td></tr></table></figure><ol start="6"><li><font style="color:rgba(0, 0, 0, 0.75);">.bc到.s编译指令</font></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">clang -S -fobjc-arc struct.bc -o struct.s<br></code></pre></td></tr></table></figure><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><p>clang   llvm</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br><span class="hljs-built_in">sudo</span> apt install llvm clang llvm-dev llvm-runtime lldb<br></code></pre></td></tr></table></figure><p>检查版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">llvm-config --version<br>clang --version<br></code></pre></td></tr></table></figure><h3 id="1-处理-bc-文件"><a href="#1-处理-bc-文件" class="headerlink" title="1. 处理 **&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;** 文件"></a><strong><font style="color:rgb(64, 64, 64);">1. 处理 </font></strong><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><strong><font style="color:rgb(64, 64, 64);"> 文件</font></strong></h3><p><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> </font><font style="color:rgb(64, 64, 64);">文件是 LLVM 中间表示（IR）的二进制格式。要逆向分析它，需将其转换为可读的文本格式（</font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.ll&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">）。</font></p><h4 id="a-转换为-LLVM-IR-文本格式"><a href="#a-转换为-LLVM-IR-文本格式" class="headerlink" title="a. 转换为 LLVM IR 文本格式"></a><strong><font style="color:rgb(64, 64, 64);">a. 转换为 LLVM IR 文本格式</font></strong></h4><p><font style="color:rgb(64, 64, 64);">使用 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;llvm-dis&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 工具（LLVM 反汇编器）：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">llvm-dis input.bc -o output.ll<br></code></pre></td></tr></table></figure><p><font style="color:rgb(64, 64, 64);">生成的</font><font style="color:rgb(64, 64, 64);"> </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;output.ll&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> </font><font style="color:rgb(64, 64, 64);">是文本形式的 LLVM IR，可用文本编辑器查看。</font></p><h4 id="b-直接查看-bc-文件信息"><a href="#b-直接查看-bc-文件信息" class="headerlink" title="b. 直接查看**** **&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;** ****文件信息"></a><strong><font style="color:rgb(64, 64, 64);">b. 直接查看</font>****<font style="color:rgb(64, 64, 64);"> </font></strong><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><strong><font style="color:rgb(64, 64, 64);"> </font>****<font style="color:rgb(64, 64, 64);">文件信息</font></strong></h4><p><font style="color:rgb(64, 64, 64);">分析 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 文件结构：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">llvm-bcanalyzer input.bc<br></code></pre></td></tr></table></figure><hr><h3 id="2-使用-Clang-编译-反编译"><a href="#2-使用-Clang-编译-反编译" class="headerlink" title="2. 使用 Clang 编译&#x2F;反编译"></a><strong><font style="color:rgb(64, 64, 64);">2. 使用 Clang 编译&#x2F;反编译</font></strong></h3><h4 id="a-将-bc-编译为可执行文件"><a href="#a-将-bc-编译为可执行文件" class="headerlink" title="a. 将 **&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;** 编译为可执行文件"></a><strong><font style="color:rgb(64, 64, 64);">a. 将 </font></strong><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><strong><font style="color:rgb(64, 64, 64);"> 编译为可执行文件</font></strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clang input.bc -o output<br></code></pre></td></tr></table></figure><p><font style="color:rgb(64, 64, 64);">生成的可执行文件</font><font style="color:rgb(64, 64, 64);"> </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;output&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> </font><font style="color:rgb(64, 64, 64);">可用逆向工具（如 Ghidra、IDA Pro）分析。</font></p><h4 id="b-反编译为-C-代码（需额外工具）"><a href="#b-反编译为-C-代码（需额外工具）" class="headerlink" title="b. 反编译为 C 代码（需额外工具）"></a><strong><font style="color:rgb(64, 64, 64);">b. 反编译为 C 代码（需额外工具）</font></strong></h4><p><font style="color:rgb(64, 64, 64);">直接反编译 LLVM IR 到 C 代码需要第三方工具，例如：</font></p><p><strong><font style="color:rgb(64, 64, 64);">RetDec</font></strong><font style="color:rgb(64, 64, 64);">：支持 LLVM IR 反编译。</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 安装 RetDec<br>git clone https://github.com/avast/retdec.git<br>cd retdec<br>./retdec-support.sh<br>mkdir build &amp;&amp; cd build<br>cmake .. -DCMAKE_INSTALL_PREFIX=/path/to/install<br>make &amp;&amp; make install<br><br># 使用 RetDec 反编译<br>retdec-decompiler.py input.bc<br></code></pre></td></tr></table></figure><hr><h3 id="3-动态分析（调试）"><a href="#3-动态分析（调试）" class="headerlink" title="3. 动态分析（调试）"></a><strong><font style="color:rgb(64, 64, 64);">3. 动态分析（调试）</font></strong></h3><p><font style="color:rgb(64, 64, 64);">使用 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;lli&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">（LLVM 解释器）直接运行 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 文件：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lli input.bc<br></code></pre></td></tr></table></figure><p><font style="color:rgb(64, 64, 64);">结合调试器（如 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;gdb&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 或 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;lldb&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">）跟踪执行流程：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lldb -- lli input.bc<br></code></pre></td></tr></table></figure><h1 id="bc版本兼容问题"><a href="#bc版本兼容问题" class="headerlink" title="bc版本兼容问题"></a><font style="color:#000000;background-color:#FFFFFF;">bc版本兼容问题</font></h1><p>最好根据原生编译平台去下载</p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/5.png"></p><p>个人做法是查看内容安装对应版本</p><p><font style="color:rgb(64, 64, 64);">将 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 转换为 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.ll&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">（LLVM IR 文本格式），查看头部信息：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">llvm-dis Dragon.bc -o Dragon.ll<br><span class="hljs-built_in">head</span> -n 20 Dragon.ll<br></code></pre></td></tr></table></figure><p><font style="color:rgb(64, 64, 64);">关键信息：</font></p><ul><li><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;target triple&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">：目标平台（可推断兼容的 LLVM 版本）。</font></li></ul><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/6.png"></p><ul><li><font style="color:rgb(64, 64, 64);">如果文件包含 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;llvm.ident&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">，会显示 Clang 版本：</font></li></ul><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/7.png"></p><p>是windows下vs生成的，但版本切换麻烦，直接kali安装了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://apt.llvm.org/llvm.sh<br><span class="hljs-built_in">chmod</span> +x llvm.sh<br><span class="hljs-built_in">sudo</span> ./llvm.sh 17<br><span class="hljs-built_in">sudo</span> apt install clang-17<br></code></pre></td></tr></table></figure><p><strong><font style="color:rgb(64, 64, 64);">编译时指定目标三元组</font></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clang-17 -target x86_64-pc-windows-msvc19.39.33522 Dragon.bc -o output<br></code></pre></td></tr></table></figure><p>切换版本可以参考这个：<a href="https://blog.csdn.net/weixin_45100742/article/details/139897786">https://blog.csdn.net/weixin_45100742&#x2F;article&#x2F;details&#x2F;139897786</a></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/8.png"></p><p>遭遇该报错</p><p><strong><font style="color:rgb(64, 64, 64);">错误原因</font></strong></p><ul><li><font style="color:rgb(64, 64, 64);">你正在</font><font style="color:rgb(64, 64, 64);"> </font><strong><font style="color:rgb(64, 64, 64);">Linux（Kali）上编译一个面向 Windows（</font></strong><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;x86_64-pc-windows-msvc&lt;/font&gt;**</code><strong><font style="color:rgb(64, 64, 64);">）的 LLVM Bitcode 文件</font></strong><font style="color:rgb(64, 64, 64);">。</font></li><li><font style="color:rgb(64, 64, 64);">Clang 默认会尝试调用 Linux 的链接器 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;ld&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">，但 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;.bc&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);"> 文件包含 </font><strong><font style="color:rgb(64, 64, 64);">MSVC 特有的库依赖</font></strong><font style="color:rgb(64, 64, 64);">（如 </font><code>**&lt;font style=&quot;color:rgb(64, 64, 64);background-color:rgb(236, 236, 236);&quot;&gt;libcmt&lt;/font&gt;**</code><font style="color:rgb(64, 64, 64);">，Windows 的 C 运行时库）。</font></li></ul><p>用vscode配置环境：<a href="https://zhuanlan.zhihu.com/p/613922486">https://zhuanlan.zhihu.com/p/613922486</a></p><p>llvm下载网址：<a href="https://releases.llvm.org/download.html">https://releases.llvm.org/download.html</a></p><p>安装llvm配置环境变量，将<font style="color:rgb(25, 27, 31);">mingw64 文件夹中的所有文件拷贝到 LLVM</font></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/9.png"></p><p>正式逆向Dragon.bc文件（XYCTF2025–Re）</p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/10.png"></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/11.png"></p><p>:::tips<br><strong><font style="color:rgb(25, 27, 31);">–target&#x3D;x86_64-w64-windows-gnu</font></strong><font style="color:rgb(25, 27, 31);"> 或 </font><strong><font style="color:rgb(25, 27, 31);">–target&#x3D;x86_64-w64-mingw </font></strong></p><p>:::</p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/12.png"></p><p><img src="/2025/04/06/BC%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/13.png"></p><p>可以vs下载msvc库，但不影响，exe已生成，可以逆向了</p><p><strong><font style="color:rgb(64, 64, 64);"></font></strong></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>XCTF-TPCTF2025</title>
    <link href="/2025/03/25/XCTF-TPCTF2025/"/>
    <url>/2025/03/25/XCTF-TPCTF2025/</url>
    
    <content type="html"><![CDATA[<p>鄙人萌新，第一次搭博客上传的这份wp，如有不足之处还望多多包含</p><p>题目来源：<a href="https://github.com/tp-ctf/TPCTF2025/tree/main">https://github.com/tp-ctf/TPCTF2025/tree/main</a></p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><p>文章复现转载涉及链接：</p><p><a href="https://blog.xmcve.com/2025/03/11/TPCTF2025-Writeup/#title-12">https://blog.xmcve.com/2025/03/11/TPCTF2025-Writeup/</a></p><p><a href="https://patr1ck-s.github.io/2025/03/10/2025-TPCTF-RE-wp/">https://patr1ck-s.github.io/2025/03/10/2025-TPCTF-RE-wp/</a></p><h2 id="chase"><a href="#chase" class="headerlink" title="chase"></a><font style="color:#000000;background-color:#FFFFFF;">chase</font></h2><img src="/2025/03/25/XCTF-TPCTF2025/1.png" class="" title="[]"><p>第一段用ce修改得分直接通关，注意得分数据是一个字节的</p><p><font style="color:rgb(85, 85, 85);">在ppu查看器里看见第二段flag</font></p><img src="/2025/03/25/XCTF-TPCTF2025/2.png" class="" title="[]"><p>本机是debug里，有的在tool里</p><p>这里能看到第三段flag，ppu里的每个字符都有显示不同的Tile值</p><p>原理就是tile值映射可见输出字符，找flag（262c2127）对应tile值去二进制内查看</p><img src="/2025/03/25/XCTF-TPCTF2025/3.png" class="" title="[]"><p>字符最大到3F截至，有00隔开，内容容易区分，两段内容对应flag2 3</p><p>写脚本映射即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">table = &#123;<span class="hljs-number">0xd0</span>: <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-number">0xd1</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-number">0xd2</span>: <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-number">0xd3</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-number">0xd4</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-number">0xd5</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-number">0xd6</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-number">0xd7</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-number">0xd8</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-number">0xd9</span>: <span class="hljs-string">&#x27;9&#x27;</span>,<br>         <span class="hljs-number">33</span>: <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-number">34</span>: <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-number">35</span>: <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-number">36</span>: <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-number">37</span>: <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-number">38</span>: <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-number">39</span>: <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-number">40</span>: <span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-number">41</span>: <span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-number">42</span>: <span class="hljs-string">&#x27;J&#x27;</span>, <span class="hljs-number">43</span>: <span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-number">44</span>: <span class="hljs-string">&#x27;L&#x27;</span>,<br>         <span class="hljs-number">45</span>: <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-number">46</span>: <span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-number">47</span>: <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-number">48</span>: <span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-number">49</span>: <span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-number">50</span>: <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-number">51</span>: <span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-number">52</span>: <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-number">53</span>: <span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-number">54</span>: <span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-number">55</span>: <span class="hljs-string">&#x27;W&#x27;</span>, <span class="hljs-number">56</span>: <span class="hljs-string">&#x27;X&#x27;</span>,<br>         <span class="hljs-number">57</span>: <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-number">58</span>: <span class="hljs-string">&#x27;Z&#x27;</span>, <span class="hljs-number">0x3d</span>: <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-number">0x1a</span>: <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">0x1b</span>: <span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-number">0x1c</span>: <span class="hljs-string">&#x27;&lt;&#x27;</span>, <span class="hljs-number">0x1d</span>: <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">0x1e</span>: <span class="hljs-string">&#x27;&gt;&#x27;</span>, <span class="hljs-number">0x20</span>: <span class="hljs-string">&#x27;@&#x27;</span>, <span class="hljs-number">0x00</span>: <span class="hljs-string">&#x27; &#x27;</span>,<br>         <span class="hljs-number">0x0e</span>: <span class="hljs-string">&#x27;.&#x27;</span>,<br>         <span class="hljs-number">0x3b</span>: <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-number">0x3c</span>: <span class="hljs-string">&#x27;&#125;&#x27;</span>&#125;<br>enc = [<br>    <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2F</span>,<br>    <span class="hljs-number">0x32</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xA4</span>,<br>    <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD6</span>,<br>    <span class="hljs-number">0x20</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3D</span><br>]<br><br>flag2 = <span class="hljs-string">&#x27;&#x27;</span>.join(table.get(i, <span class="hljs-string">&#x27;*&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc)<br><span class="hljs-built_in">print</span>(flag2)<br>enc1 = [<br>    <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2F</span>,<br>    <span class="hljs-number">0x32</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x34</span>,<br>    <span class="hljs-number">0x30</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x3D</span>,<br>    <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x3D</span><br>]<br>flag3 = <span class="hljs-string">&#x27;&#x27;</span>.join(table.get(i, <span class="hljs-string">&#x27;*&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc1)<br><span class="hljs-built_in">print</span>(flag3)<br><span class="hljs-comment"># FLAG PT.2 FOR YOU IS *** **PLAY1N9_6@M3S_</span><br><span class="hljs-comment"># FLAG PT.1 FOR YOU IS *JTPCTF&#123;D0_Y0U_L1KE_</span><br></code></pre></td></tr></table></figure><p><font style="color:rgb(85, 85, 85);">TPCTF{D0_Y0U_L1KE_PLAY1N9_6@M3S_ON_Y0UR_N3S?}</font></p><p>有个类似的题目，思路跟这题不一样：<a href="https://www.cnblogs.com/harmonica11/p/13456725.html">https://www.cnblogs.com/harmonica11/p/13456725.html</a></p><p>这明明是misc题</p><h2 id="linuxpdf"><a href="#linuxpdf" class="headerlink" title="linuxpdf"></a>linuxpdf</h2><p>pdf文件，需要在chrome下运行，edge不行</p><p>原主运行和题目运行的内容有所区别</p><img src="/2025/03/25/XCTF-TPCTF2025/4.png" class="" title="[]"><img src="/2025/03/25/XCTF-TPCTF2025/5.png" class="" title="[]"><img src="/2025/03/25/XCTF-TPCTF2025/6.png" class="" title="[]"><p>flag的出现跟a9文件加载有关</p><img src="/2025/03/25/XCTF-TPCTF2025/7.png" class="" title="[]"><p>可以看到相关base64加密内容</p><p>用脚本提取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> zlib<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base64_decode_and_inflate</span>(<span class="hljs-params">encoded_data</span>):<br>    <span class="hljs-keyword">try</span>:<br><br>        compressed_data = base64.b64decode(encoded_data)<br><br>        <span class="hljs-keyword">try</span>:<br>            decompressed_data = zlib.decompress(compressed_data)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据格式: zlib&quot;</span>)<br>        <span class="hljs-keyword">except</span> zlib.error:<br><br>            <span class="hljs-keyword">try</span>:<br>                decompressed_data = zlib.decompress(compressed_data, <span class="hljs-number">16</span> + zlib.MAX_WBITS)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据格式: gzip&quot;</span>)<br>            <span class="hljs-keyword">except</span> zlib.error:<br><br>                <span class="hljs-keyword">try</span>:<br>                    decompressed_data = zlib.decompress(compressed_data, -zlib.MAX_WBITS)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据格式: raw deflate&quot;</span>)<br>                <span class="hljs-keyword">except</span> zlib.error <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解压缩失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>        <span class="hljs-keyword">return</span> decompressed_data<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解压缩失败: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;D:\CTF\ctftimu\tpctf\linuxpdf\linux.pdf&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    res = f.read()<br>    start_index = res.find(<span class="hljs-string">&quot;\&quot;vm_64.cfg\&quot;&quot;</span>)<br>    ret = res[start_index:res.find(<span class="hljs-string">&quot;for \\(let filename i&quot;</span>)][:-<span class="hljs-number">4</span>]<br><br>    list_1 = ret.split(<span class="hljs-string">&quot;, &quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(list_1)):<br>        ret = list_1[i].split(<span class="hljs-string">&quot;: &quot;</span>)[<span class="hljs-number">0</span>].replace(<span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>        data = list_1[i].split(<span class="hljs-string">&quot;: &quot;</span>)[<span class="hljs-number">1</span>].replace(<span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>        res = base64_decode_and_inflate(data)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ret&#125;</span>&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f1:<br>            f1.write(res)<br></code></pre></td></tr></table></figure><img src="/2025/03/25/XCTF-TPCTF2025/8.png" class="" title="[]">ida打开<img src="/2025/03/25/XCTF-TPCTF2025/9.png" class="" title="[]"><p>ida分析a9文件为md5加密</p><p>unk_4008标签找到数据(ida9伪c或者低版本直接看)</p><img src="/2025/03/25/XCTF-TPCTF2025/10.png" class="" title="[]"><p>16位为一组，第一个解出来为F，以此为FDP，倒着解密</p><p>wp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>enc = [<span class="hljs-number">56</span>, <span class="hljs-number">248</span>, <span class="hljs-number">138</span>, <span class="hljs-number">59</span>, <span class="hljs-number">197</span>, <span class="hljs-number">112</span>, <span class="hljs-number">33</span>, <span class="hljs-number">15</span>, <span class="hljs-number">138</span>, <span class="hljs-number">141</span>, <span class="hljs-number">149</span>, <span class="hljs-number">88</span>, <span class="hljs-number">91</span>, <span class="hljs-number">70</span>, <span class="hljs-number">176</span>, <span class="hljs-number">101</span>, <span class="hljs-number">0</span>, <span class="hljs-number">131</span>, <span class="hljs-number">5</span>, <span class="hljs-number">90</span>, <span class="hljs-number">232</span>, <span class="hljs-number">12</span>, <span class="hljs-number">220</span>, <span class="hljs-number">139</span>, <span class="hljs-number">213</span>, <span class="hljs-number">147</span>, <span class="hljs-number">120</span>, <span class="hljs-number">184</span>, <span class="hljs-number">98</span>, <span class="hljs-number">141</span>, <span class="hljs-number">115</span>, <span class="hljs-number">63</span>, <span class="hljs-number">203</span>, <span class="hljs-number">0</span>, <span class="hljs-number">250</span>, <span class="hljs-number">125</span>, <span class="hljs-number">175</span>, <span class="hljs-number">251</span>, <span class="hljs-number">215</span>, <span class="hljs-number">172</span>, <span class="hljs-number">236</span>, <span class="hljs-number">19</span>, <span class="hljs-number">176</span>, <span class="hljs-number">105</span>, <span class="hljs-number">93</span>, <span class="hljs-number">147</span>, <span class="hljs-number">90</span>, <span class="hljs-number">4</span>, <br>       <span class="hljs-number">188</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">194</span>, <span class="hljs-number">156</span>, <span class="hljs-number">192</span>, <span class="hljs-number">253</span>, <span class="hljs-number">56</span>, <span class="hljs-number">1</span>, <span class="hljs-number">199</span>, <span class="hljs-number">253</span>, <span class="hljs-number">211</span>, <span class="hljs-number">21</span>, <span class="hljs-number">199</span>, <span class="hljs-number">130</span>, <span class="hljs-number">153</span>, <span class="hljs-number">155</span>, <span class="hljs-number">212</span>, <br>       <span class="hljs-number">203</span>, <span class="hljs-number">0</span>, <span class="hljs-number">43</span>, <span class="hljs-number">162</span>, <span class="hljs-number">208</span>, <span class="hljs-number">26</span>, <span class="hljs-number">241</span>, <span class="hljs-number">45</span>, <span class="hljs-number">155</span>, <span class="hljs-number">227</span>, <span class="hljs-number">26</span>, <span class="hljs-number">43</span>, <span class="hljs-number">68</span>, <span class="hljs-number">50</span>, <span class="hljs-number">60</span>, <span class="hljs-number">26</span>, <span class="hljs-number">79</span>,<br>       <span class="hljs-number">71</span>, <span class="hljs-number">0</span>, <span class="hljs-number">221</span>, <span class="hljs-number">238</span>, <span class="hljs-number">186</span>, <span class="hljs-number">240</span>, <span class="hljs-number">2</span>, <span class="hljs-number">82</span>, <span class="hljs-number">122</span>, <span class="hljs-number">158</span>, <span class="hljs-number">173</span>, <span class="hljs-number">120</span>, <span class="hljs-number">189</span>, <span class="hljs-number">22</span>, <br>       <span class="hljs-number">104</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">204</span>, <span class="hljs-number">0</span>, <span class="hljs-number">191</span>, <span class="hljs-number">149</span>, <span class="hljs-number">184</span>, <span class="hljs-number">153</span>, <span class="hljs-number">52</span>, <span class="hljs-number">161</span>, <span class="hljs-number">181</span>, <span class="hljs-number">85</span>, <span class="hljs-number">225</span>,<br>       <span class="hljs-number">9</span>, <span class="hljs-number">15</span>, <span class="hljs-number">236</span>, <span class="hljs-number">223</span>, <span class="hljs-number">211</span>, <span class="hljs-number">218</span>, <span class="hljs-number">159</span>, <span class="hljs-number">0</span>, <span class="hljs-number">182</span>, <span class="hljs-number">66</span>, <span class="hljs-number">44</span>, <span class="hljs-number">48</span>, <span class="hljs-number">176</span>, <span class="hljs-number">41</span>, <span class="hljs-number">56</span>,<br>       <span class="hljs-number">83</span>, <span class="hljs-number">95</span>, <span class="hljs-number">142</span>, <span class="hljs-number">100</span>, <span class="hljs-number">141</span>, <span class="hljs-number">96</span>, <span class="hljs-number">168</span>, <span class="hljs-number">123</span>, <span class="hljs-number">148</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">193</span>, <span class="hljs-number">183</span>, <span class="hljs-number">102</span>, <span class="hljs-number">67</span>,<br>       <span class="hljs-number">175</span>, <span class="hljs-number">141</span>, <span class="hljs-number">213</span>, <span class="hljs-number">12</span>, <span class="hljs-number">176</span>, <span class="hljs-number">109</span>, <span class="hljs-number">127</span>, <span class="hljs-number">221</span>, <span class="hljs-number">60</span>, <span class="hljs-number">248</span>, <span class="hljs-number">237</span>, <span class="hljs-number">0</span>, <span class="hljs-number">66</span>, <span class="hljs-number">214</span>, <span class="hljs-number">151</span>,<br>       <span class="hljs-number">25</span>, <span class="hljs-number">249</span>, <span class="hljs-number">112</span>, <span class="hljs-number">136</span>, <span class="hljs-number">240</span>, <span class="hljs-number">101</span>, <span class="hljs-number">64</span>, <span class="hljs-number">244</span>, <span class="hljs-number">18</span>, <span class="hljs-number">220</span>, <span class="hljs-number">23</span>, <span class="hljs-number">6</span>, <span class="hljs-number">251</span>, <span class="hljs-number">0</span>, <span class="hljs-number">161</span>, <span class="hljs-number">242</span>,<br>       <span class="hljs-number">61</span>, <span class="hljs-number">166</span>, <span class="hljs-number">22</span>, <span class="hljs-number">21</span>, <span class="hljs-number">64</span>, <span class="hljs-number">14</span>, <span class="hljs-number">123</span>, <span class="hljs-number">217</span>, <span class="hljs-number">234</span>, <span class="hljs-number">114</span>, <span class="hljs-number">214</span>, <span class="hljs-number">53</span>, <span class="hljs-number">103</span>, <span class="hljs-number">235</span>, <span class="hljs-number">0</span>, <span class="hljs-number">78</span>, <span class="hljs-number">36</span>,<br>       <span class="hljs-number">111</span>, <span class="hljs-number">10</span>, <span class="hljs-number">93</span>, <span class="hljs-number">211</span>, <span class="hljs-number">206</span>, <span class="hljs-number">89</span>, <span class="hljs-number">70</span>, <span class="hljs-number">95</span>, <span class="hljs-number">243</span>, <span class="hljs-number">208</span>, <span class="hljs-number">46</span>, <span class="hljs-number">196</span>, <span class="hljs-number">249</span>, <span class="hljs-number">132</span>, <span class="hljs-number">0</span>, <span class="hljs-number">184</span>, <span class="hljs-number">207</span>, <br>       <span class="hljs-number">37</span>, <span class="hljs-number">249</span>, <span class="hljs-number">99</span>, <span class="hljs-number">232</span>, <span class="hljs-number">233</span>, <span class="hljs-number">244</span>, <span class="hljs-number">195</span>, <span class="hljs-number">253</span>, <span class="hljs-number">218</span>, <span class="hljs-number">52</span>, <span class="hljs-number">246</span>, <span class="hljs-number">240</span>, <span class="hljs-number">26</span>, <span class="hljs-number">53</span>, <span class="hljs-number">0</span>, <span class="hljs-number">45</span>, <span class="hljs-number">152</span>, <span class="hljs-number">216</span>,<br>       <span class="hljs-number">32</span>, <span class="hljs-number">131</span>, <span class="hljs-number">92</span>, <span class="hljs-number">117</span>, <span class="hljs-number">169</span>, <span class="hljs-number">249</span>, <span class="hljs-number">129</span>, <span class="hljs-number">173</span>, <span class="hljs-number">77</span>, <span class="hljs-number">184</span>, <span class="hljs-number">38</span>, <span class="hljs-number">191</span>, <span class="hljs-number">142</span>, <span class="hljs-number">0</span>, <span class="hljs-number">112</span>, <span class="hljs-number">46</span>, <span class="hljs-number">173</span>, <span class="hljs-number">8</span>, <span class="hljs-number">163</span>,<br>       <span class="hljs-number">221</span>, <span class="hljs-number">86</span>, <span class="hljs-number">179</span>, <span class="hljs-number">19</span>, <span class="hljs-number">76</span>, <span class="hljs-number">124</span>, <span class="hljs-number">56</span>, <span class="hljs-number">65</span>, <span class="hljs-number">166</span>, <span class="hljs-number">82</span>, <span class="hljs-number">170</span>, <span class="hljs-number">0</span>, <span class="hljs-number">210</span>, <span class="hljs-number">213</span>, <span class="hljs-number">87</span>, <span class="hljs-number">182</span>, <span class="hljs-number">19</span>, <span class="hljs-number">102</span>, <span class="hljs-number">43</span>, <br>       <span class="hljs-number">146</span>, <span class="hljs-number">243</span>, <span class="hljs-number">153</span>, <span class="hljs-number">214</span>, <span class="hljs-number">18</span>, <span class="hljs-number">251</span>, <span class="hljs-number">145</span>, <span class="hljs-number">89</span>, <span class="hljs-number">30</span>, <span class="hljs-number">0</span>, <span class="hljs-number">228</span>, <span class="hljs-number">66</span>, <span class="hljs-number">43</span>, <span class="hljs-number">99</span>, <span class="hljs-number">32</span>, <span class="hljs-number">237</span>, <span class="hljs-number">152</span>, <span class="hljs-number">158</span>, <span class="hljs-number">126</span>,<br>       <span class="hljs-number">60</span>, <span class="hljs-number">185</span>, <span class="hljs-number">127</span>, <span class="hljs-number">54</span>, <span class="hljs-number">156</span>, <span class="hljs-number">186</span>, <span class="hljs-number">56</span>, <span class="hljs-number">0</span>, <span class="hljs-number">113</span>, <span class="hljs-number">128</span>, <span class="hljs-number">53</span>, <span class="hljs-number">134</span>, <span class="hljs-number">198</span>, <span class="hljs-number">112</span>, <span class="hljs-number">89</span>, <span class="hljs-number">221</span>, <span class="hljs-number">163</span>, <span class="hljs-number">37</span>, <br>       <span class="hljs-number">37</span>, <span class="hljs-number">206</span>, <span class="hljs-number">132</span>, <span class="hljs-number">76</span>, <span class="hljs-number">80</span>, <span class="hljs-number">121</span>, <span class="hljs-number">0</span>, <span class="hljs-number">131</span>, <span class="hljs-number">179</span>, <span class="hljs-number">113</span>, <span class="hljs-number">128</span>, <span class="hljs-number">29</span>, <span class="hljs-number">10</span>, <span class="hljs-number">222</span>, <span class="hljs-number">7</span>, <span class="hljs-number">181</span>, <span class="hljs-number">196</span>, <span class="hljs-number">245</span>, <br>       <span class="hljs-number">30</span>, <span class="hljs-number">140</span>, <span class="hljs-number">98</span>, <span class="hljs-number">21</span>, <span class="hljs-number">226</span>, <span class="hljs-number">0</span>, <span class="hljs-number">176</span>, <span class="hljs-number">209</span>, <span class="hljs-number">180</span>, <span class="hljs-number">136</span>, <span class="hljs-number">91</span>, <span class="hljs-number">194</span>, <span class="hljs-number">253</span>, <span class="hljs-number">197</span>, <span class="hljs-number">166</span>, <span class="hljs-number">101</span>, <span class="hljs-number">38</span>, <br>       <span class="hljs-number">105</span>, <span class="hljs-number">36</span>, <span class="hljs-number">72</span>, <span class="hljs-number">108</span>, <span class="hljs-number">95</span>, <span class="hljs-number">0</span>, <span class="hljs-number">121</span>, <span class="hljs-number">44</span>, <span class="hljs-number">158</span>, <span class="hljs-number">127</span>, <span class="hljs-number">5</span>, <span class="hljs-number">196</span>, <span class="hljs-number">7</span>, <span class="hljs-number">197</span>, <span class="hljs-number">111</span>, <span class="hljs-number">59</span>, <span class="hljs-number">236</span>, <span class="hljs-number">76</span>, <br>       <span class="hljs-number">167</span>, <span class="hljs-number">229</span>, <span class="hljs-number">193</span>, <span class="hljs-number">113</span>, <span class="hljs-number">0</span>, <span class="hljs-number">56</span>, <span class="hljs-number">85</span>, <span class="hljs-number">229</span>, <span class="hljs-number">165</span>, <span class="hljs-number">187</span>, <span class="hljs-number">193</span>, <span class="hljs-number">203</span>, <span class="hljs-number">225</span>, <span class="hljs-number">138</span>, <span class="hljs-number">110</span>, <span class="hljs-number">171</span>,<br>       <span class="hljs-number">93</span>, <span class="hljs-number">217</span>, <span class="hljs-number">124</span>, <span class="hljs-number">6</span>, <span class="hljs-number">60</span>, <span class="hljs-number">0</span>, <span class="hljs-number">136</span>, <span class="hljs-number">109</span>, <span class="hljs-number">69</span>, <span class="hljs-number">224</span>, <span class="hljs-number">69</span>, <span class="hljs-number">27</span>, <span class="hljs-number">187</span>, <span class="hljs-number">167</span>, <span class="hljs-number">192</span>, <span class="hljs-number">52</span>, <span class="hljs-number">31</span>, <br>       <span class="hljs-number">233</span>, <span class="hljs-number">10</span>, <span class="hljs-number">149</span>, <span class="hljs-number">79</span>, <span class="hljs-number">52</span>, <span class="hljs-number">0</span>, <span class="hljs-number">58</span>, <span class="hljs-number">67</span>, <span class="hljs-number">124</span>, <span class="hljs-number">190</span>, <span class="hljs-number">101</span>, <span class="hljs-number">145</span>, <span class="hljs-number">234</span>, <span class="hljs-number">52</span>, <span class="hljs-number">137</span>, <span class="hljs-number">100</span>, <br>       <span class="hljs-number">37</span>, <span class="hljs-number">133</span>, <span class="hljs-number">110</span>, <span class="hljs-number">174</span>, <span class="hljs-number">123</span>, <span class="hljs-number">101</span>, <span class="hljs-number">0</span>, <span class="hljs-number">52</span>, <span class="hljs-number">48</span>, <span class="hljs-number">73</span>, <span class="hljs-number">103</span>, <span class="hljs-number">160</span>, <span class="hljs-number">103</span>, <span class="hljs-number">48</span>, <span class="hljs-number">138</span>, <span class="hljs-number">118</span>, <br>       <span class="hljs-number">112</span>, <span class="hljs-number">31</span>, <span class="hljs-number">5</span>, <span class="hljs-number">192</span>, <span class="hljs-number">102</span>, <span class="hljs-number">133</span>, <span class="hljs-number">81</span>, <span class="hljs-number">0</span>, <span class="hljs-number">214</span>, <span class="hljs-number">175</span>, <span class="hljs-number">124</span>, <span class="hljs-number">79</span>, <span class="hljs-number">237</span>, <span class="hljs-number">207</span>, <span class="hljs-number">43</span>, <span class="hljs-number">103</span>, <br>       <span class="hljs-number">119</span>, <span class="hljs-number">223</span>, <span class="hljs-number">142</span>, <span class="hljs-number">131</span>, <span class="hljs-number">201</span>, <span class="hljs-number">50</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>, <span class="hljs-number">0</span>, <span class="hljs-number">223</span>, <span class="hljs-number">136</span>, <span class="hljs-number">147</span>, <span class="hljs-number">30</span>, <span class="hljs-number">126</span>, <span class="hljs-number">239</span>, <br>       <span class="hljs-number">223</span>, <span class="hljs-number">204</span>, <span class="hljs-number">43</span>, <span class="hljs-number">184</span>, <span class="hljs-number">13</span>, <span class="hljs-number">74</span>, <span class="hljs-number">79</span>, <span class="hljs-number">87</span>, <span class="hljs-number">16</span>, <span class="hljs-number">251</span>, <span class="hljs-number">0</span>, <span class="hljs-number">203</span>, <span class="hljs-number">15</span>, <span class="hljs-number">200</span>, <span class="hljs-number">19</span>, <span class="hljs-number">117</span>, <span class="hljs-number">90</span>,<br>       <span class="hljs-number">69</span>, <span class="hljs-number">206</span>, <span class="hljs-number">89</span>, <span class="hljs-number">132</span>, <span class="hljs-number">191</span>, <span class="hljs-number">186</span>, <span class="hljs-number">21</span>, <span class="hljs-number">132</span>, <span class="hljs-number">124</span>, <span class="hljs-number">30</span>]<br><br>data = [[<span class="hljs-number">0</span>] * <span class="hljs-number">16</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">28</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">28</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        data[i][j] = enc[i * <span class="hljs-number">17</span> + j]<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;F&#125;&quot;</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        temp = <span class="hljs-built_in">chr</span>(t) + <span class="hljs-built_in">str</span><br>        <span class="hljs-keyword">if</span> md5(temp.encode()).digest() == <span class="hljs-built_in">bytes</span>(data[j]): <span class="hljs-comment">#哈希值校验b&#x27;\x5d&#x27;16字节二进制格式</span><br>            <span class="hljs-built_in">str</span> = temp<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>)<br></code></pre></td></tr></table></figure><h2 id="magicfile"><a href="#magicfile" class="headerlink" title="magicfile"></a>magicfile</h2><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">文件给的主要是libmagic编译的程序 其中加载了自定应的二进制类型的mgc文件</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">可以参考2023 *CTF的一个类似题目</font></p><img src="/2025/03/25/XCTF-TPCTF2025/11.png" class="" title="[]"><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">从程序提取出mgc文件 第二个参数是地址 第三个参数是size</font></p><img src="/2025/03/25/XCTF-TPCTF2025/12.png" class="" title="[]"><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">写脚本解析 输出所有规则后 找0x2F为}的</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> string<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./dump&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)<br><br><span class="hljs-comment">#f = open(&#x27;./test.magic.mgc&#x27;, &#x27;rb&#x27;)</span><br><br>b = f.read(<span class="hljs-number">0x178</span>)<br>indexes = []<br>table = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    b = f.read(<span class="hljs-number">0x178</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(b) != <span class="hljs-number">0x178</span>:<br>        <span class="hljs-keyword">break</span><br>    line = b[:<span class="hljs-number">0x30</span>]<br>    _<span class="hljs-built_in">type</span> = line[<span class="hljs-number">6</span>]<br>    text = b[<span class="hljs-number">0xa0</span>:].decode()<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;Try again&quot;</span> <span class="hljs-keyword">in</span> text):<br>        text = <span class="hljs-string">&quot;Try again&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        text = <span class="hljs-string">&quot;&quot;</span><br>    off = struct.unpack_from(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, line, <span class="hljs-number">0x0c</span>)[<span class="hljs-number">0</span>]<br>    s = <span class="hljs-string">f&#x27;type: <span class="hljs-subst">&#123;_<span class="hljs-built_in">type</span>:02X&#125;</span>, off: <span class="hljs-subst">&#123;off:02X&#125;</span>, text = &#x27;</span>+text.strip()<br>    <span class="hljs-keyword">if</span> _<span class="hljs-built_in">type</span> == <span class="hljs-number">5</span>:<br>        s += <span class="hljs-string">&#x27;, str: &#x27;</span>+line[<span class="hljs-number">0x20</span>:].decode()<br>        <span class="hljs-built_in">print</span>(s)<br>    <span class="hljs-keyword">elif</span> _<span class="hljs-built_in">type</span> == <span class="hljs-number">1</span>:<br>        n1, n2 = line[<span class="hljs-number">0x18</span>], line[<span class="hljs-number">0x20</span>]<br>        v = n1 ^ n2<br>        s += <span class="hljs-string">f&#x27;, byte: <span class="hljs-subst">&#123;n1:02X&#125;</span> <span class="hljs-subst">&#123;n2:02X&#125;</span> <span class="hljs-subst">&#123;v:02X&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-built_in">chr</span>(v)&#125;</span>&#x27;</span><br>        table += <span class="hljs-built_in">chr</span>(v)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;Try again&quot;</span> <span class="hljs-keyword">in</span> text):<br>            <span class="hljs-built_in">print</span>(s)<br>    <span class="hljs-comment"># elif _type==3:</span><br>    <span class="hljs-comment">#     if(&quot;Try again&quot; not in text):</span><br>    <span class="hljs-comment">#         print(s)</span><br>        <span class="hljs-comment"># s+=f&#x27;, default &#x27;</span><br>    <span class="hljs-comment"># print(s)</span><br><br>flag = <span class="hljs-string">&quot;&quot;&quot;type: 01, off: 07, text = , byte: 00 6F 6F o</span><br><span class="hljs-string">type: 01, off: 08, text = , byte: 00 55 55 U</span><br><span class="hljs-string">type: 01, off: 09, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 0A, text = , byte: 00 41 41 A</span><br><span class="hljs-string">type: 01, off: 0B, text = , byte: 00 52 52 R</span><br><span class="hljs-string">type: 01, off: 0C, text = , byte: 00 33 33 3</span><br><span class="hljs-string">type: 01, off: 0D, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 0E, text = , byte: 00 53 53 S</span><br><span class="hljs-string">type: 01, off: 0F, text = , byte: 00 4F 4F O</span><br><span class="hljs-string">type: 01, off: 10, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 11, text = , byte: 00 35 35 5</span><br><span class="hljs-string">type: 01, off: 12, text = , byte: 00 6D 6D m</span><br><span class="hljs-string">type: 01, off: 13, text = , byte: 00 40 40 @</span><br><span class="hljs-string">type: 01, off: 14, text = , byte: 00 52 52 R</span><br><span class="hljs-string">type: 01, off: 15, text = , byte: 00 37 37 7</span><br><span class="hljs-string">type: 01, off: 16, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 17, text = , byte: 00 54 54 T</span><br><span class="hljs-string">type: 01, off: 18, text = , byte: 00 4F 4F O</span><br><span class="hljs-string">type: 01, off: 19, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 1A, text = , byte: 00 63 63 c</span><br><span class="hljs-string">type: 01, off: 1B, text = , byte: 00 52 52 R</span><br><span class="hljs-string">type: 01, off: 1C, text = , byte: 00 41 41 A</span><br><span class="hljs-string">type: 01, off: 1D, text = , byte: 00 43 43 C</span><br><span class="hljs-string">type: 01, off: 1E, text = , byte: 00 6B 6B k</span><br><span class="hljs-string">type: 01, off: 1F, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 20, text = , byte: 00 54 54 T</span><br><span class="hljs-string">type: 01, off: 21, text = , byte: 00 68 68 h</span><br><span class="hljs-string">type: 01, off: 22, text = , byte: 00 31 31 1</span><br><span class="hljs-string">type: 01, off: 23, text = , byte: 00 24 24 $</span><br><span class="hljs-string">type: 01, off: 24, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 25, text = , byte: 00 6D 6D m</span><br><span class="hljs-string">type: 01, off: 26, text = , byte: 00 40 40 @</span><br><span class="hljs-string">type: 01, off: 27, text = , byte: 00 39 39 9</span><br><span class="hljs-string">type: 01, off: 28, text = , byte: 00 69 69 i</span><br><span class="hljs-string">type: 01, off: 29, text = , byte: 00 43 43 C</span><br><span class="hljs-string">type: 01, off: 2A, text = , byte: 00 5F 5F _</span><br><span class="hljs-string">type: 01, off: 2B, text = , byte: 00 66 66 f</span><br><span class="hljs-string">type: 01, off: 2C, text = , byte: 00 31 31 1</span><br><span class="hljs-string">type: 01, off: 2D, text = , byte: 00 6C 6C l</span><br><span class="hljs-string">type: 01, off: 2E, text = , byte: 00 65 65 e</span><br><span class="hljs-string">type: 01, off: 2F, text = , byte: 00 7D 7D &#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag.split(<span class="hljs-string">&quot;\n&quot;</span>):<br>    <span class="hljs-built_in">print</span>(i[-<span class="hljs-number">1</span>],end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <br><span class="hljs-comment">#TPCTF&#123;oU_AR3_SO_5m@R7_TO_cRACk_Th1$_m@9iC_f1le&#125;&#125;</span><br><span class="hljs-comment">#少了一位 猜一下是 Y</span><br></code></pre></td></tr></table></figure><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">本地跑不了，不知道什么编码方式，其实找到congratulation往上翻就是flag</font></p><img src="/2025/03/25/XCTF-TPCTF2025/13.png" class="" title="[]"><p>每隔几行出一个</p><h2 id="portable"><a href="#portable" class="headerlink" title="portable"></a>portable</h2><p>MBR程序</p><img src="/2025/03/25/XCTF-TPCTF2025/14.png" class="" title="[]"><img src="/2025/03/25/XCTF-TPCTF2025/15.png" class="" title="[]"><p>包含pe和elf，写脚本提取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;portable&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>exe_data=  f[<span class="hljs-number">0x9C000</span>:]<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;dump&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>).write(exe_data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;end!!!!!!!&quot;</span>)<br><br><br>exe_data=  f[<span class="hljs-number">0x10000</span>:]<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;dump.exe&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>).write(exe_data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;end!!!!!!!&quot;</span>)<br></code></pre></td></tr></table></figure><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">分析ELF文件 根据字符串交叉引用发现关键（8.3f5不了，7.7可以？？）</font></p><img src="/2025/03/25/XCTF-TPCTF2025/16.png" class="" title="[]"><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">写脚本解密即可</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">data =[     <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x44</span>, <br>  <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x28</span>, <br>  <span class="hljs-number">0x36</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB2</span>, <br>  <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xD9</span>, <br>  <span class="hljs-number">0x1D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x30</span>, <br>  <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xEA</span>, <br>  <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xC5</span><br>]<br><br>flag = []<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(data))<br>key = <span class="hljs-string">b&quot;Cosmopolitan&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">66</span>):<br>    flag.append(data[i]^key[i%<span class="hljs-number">12</span>])<br>flag = <span class="hljs-string">b&quot;TPCTF&#123;&quot;</span>+<span class="hljs-built_in">bytes</span>(flag)+<span class="hljs-string">b&quot;&#125;&quot;</span><br><br><br><span class="hljs-comment"># 要运行的程序路径</span><br>program_path = <span class="hljs-string">&quot;./portable_ef3c5f3a7155c5a4c6f0b08606dea575.exe&quot;</span>  <span class="hljs-comment"># 替换为你的程序路径</span><br><br><span class="hljs-comment"># 要发送给程序的输入数据</span><br>input_data = <span class="hljs-string">b&quot;Hello, World!\n&quot;</span>  <span class="hljs-comment"># 替换为你的输入数据</span><br><br><span class="hljs-built_in">print</span>(flag.decode())<br></code></pre></td></tr></table></figure><h2 id="stone-game"><a href="#stone-game" class="headerlink" title="stone-game"></a><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">stone-game</font></h2><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">一个捡石子游戏AI脑袋尖尖的,规则为谁最先捡完所有的石头谁赢，题目给了源码py打包成macos的可执行文件，不过没啥用，玩了一下发现第一清空四堆石子AI每次都会清空其余三堆中的任意一堆，那么我们只需要清除最后两堆即可。安装这个逻辑写pwntools交互脚本即可。</font></p><img src="/2025/03/25/XCTF-TPCTF2025/17.png" class="" title="[]"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br>context(log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br><span class="hljs-comment"># 服务器地址和端口</span><br>HOST = <span class="hljs-string">&quot;1.95.128.179&quot;</span><br>PORT = <span class="hljs-number">3040</span><br><br><span class="hljs-comment"># 游戏逻辑常量</span><br>MAX_STONES = <span class="hljs-number">100</span><br>TOTAL_ROUNDS = <span class="hljs-number">100</span><br>WIN_THRESHOLD = <span class="hljs-number">90</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_data</span>(<span class="hljs-params">io</span>):<br>    <span class="hljs-comment"># 获取当前游戏状态</span><br>    io.recvuntil(<span class="hljs-string">b&quot;Current stone count:\n&quot;</span>)<br>    stones = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        line = io.recvline().decode().strip()<br>        <span class="hljs-built_in">print</span>(line)<br>        stones.append(<span class="hljs-built_in">int</span>(line.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>].split()[<span class="hljs-number">0</span>]))<br>    <span class="hljs-keyword">return</span> stones<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_str</span>(<span class="hljs-params">stones</span>):<br>    move = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        move += <span class="hljs-built_in">str</span>(stones[i]) + <span class="hljs-string">&quot; &quot;</span><br>    move += <span class="hljs-string">&quot;0 0 0&quot;</span><br>    <span class="hljs-keyword">return</span> move<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">play_game</span>(<span class="hljs-params">io</span>):<br>    <span class="hljs-comment"># 初始化游戏</span><br>    io.recvuntil(<span class="hljs-string">b&quot;Press Enter to start...&quot;</span>)<br>    io.sendline(<span class="hljs-string">b&quot;\n&quot;</span>)  <span class="hljs-comment"># 开始游戏</span><br><br>    player_wins = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> round_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, TOTAL_ROUNDS + <span class="hljs-number">1</span>):<br>        stones = get_data(io)<br><br>        move = get_str(stones)<br><br>        io.recvuntil(<span class="hljs-string">b&quot;0 1 0 2 0 0 0):\n&quot;</span>)<br>        io.sendline(move.encode() + <span class="hljs-string">b&quot;\n&quot;</span>)<br><br>        <br>        io.recvuntil(<span class="hljs-string">b&quot;AI is thinking...&quot;</span>)<br>        ai_move_line = io.recvline().decode().strip()<br>        log.info(<span class="hljs-string">f&quot;AI move: <span class="hljs-subst">&#123;ai_move_line&#125;</span>&quot;</span>)<br><br>        stones = get_data(io)<br>        move1 = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>            move1 += <span class="hljs-built_in">str</span>(stones[i]) + <span class="hljs-string">&quot; &quot;</span><br>        move1 = move1[:-<span class="hljs-number">1</span>]<br>        io.sendline(move1.encode() + <span class="hljs-string">b&quot;\n&quot;</span>)<br>        <span class="hljs-comment"># 检查游戏结果</span><br>        io.recvuntil(<span class="hljs-string">b&quot;Current player:&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;You won this round!&quot;</span> <span class="hljs-keyword">in</span> io.recvline():<br>            player_wins += <span class="hljs-number">1</span><br>            log.info(<span class="hljs-string">&quot;Player won this round!&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log.info(<span class="hljs-string">&quot;AI won this round!&quot;</span>)<br><br>        log.info(<span class="hljs-string">f&quot;Score after round <span class="hljs-subst">&#123;round_num&#125;</span>: <span class="hljs-subst">&#123;player_wins&#125;</span>/<span class="hljs-subst">&#123;round_num&#125;</span>&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> round_num &lt; TOTAL_ROUNDS:<br>            io.recvuntil(<span class="hljs-string">b&quot;Next round starting in 2 seconds...&quot;</span>)<br>            time.sleep(<span class="hljs-number">2</span>)<br><br>    <br>    io.recvuntil(<span class="hljs-string">b&quot;=== Challenge Complete ===&quot;</span>)<br>    final_score = io.recvline().decode().strip()<br>    log.info(<span class="hljs-string">f&quot;Final score: <span class="hljs-subst">&#123;final_score&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> player_wins &gt;= WIN_THRESHOLD:<br>        flag = io.recvline().decode().strip()<br>        log.success(<span class="hljs-string">f&quot;Flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        log.failure(<span class="hljs-string">&quot;Failed to win enough rounds to get the flag.&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <br>    io = remote(HOST, PORT)<br><br>    <span class="hljs-keyword">try</span>:<br>        play_game(io)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        log.error(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        io.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/03/22/hello-world/"/>
    <url>/2025/03/22/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
